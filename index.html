<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Online Adventskalender</title>
</head>
<body>
    <div class="hero">
        <img class="hero__logo" src="img/juh-christmas-logo.svg">
        <div class="hero__content">
            <h1 class="hero__title">Achtsamkeit Adventskalender</h1>
            <p class="hero__intro">Willkommen beim Adventskalender von <a href="https://www.jetztundhier.app" target="_blank"><strong>JETZT</strong> UND <strong>HIER</strong></a>. Hier steht jeden Tag ein T체rchen f체r Dich bereit. Findest Du das T체rchen des heutigen Tages?</p>
        </div>
    </div>
    <div class="grid">
        <button data-door-number="1" class="grid__item grid__item--sun grid__item--lg grid__item--1">
            <span class="grid__item-door">
                1
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="2" class="grid__item grid__item--2">
            <span class="grid__item-door">
                2
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="3" class="grid__item grid__item--lg grid__item--3">
            <span class="grid__item-door">
                3
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="4" class="grid__item grid__item--moss grid__item--lg grid__item--4">
            <span class="grid__item-door">
                4
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="5" class="grid__item grid__item--5">
            <span class="grid__item-door">
                5
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="6" class="grid__item grid__item--rose grid__item--lg grid__item--6">
            <span class="grid__item-door">
                6
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="7" class="grid__item grid__item--7">
            <span class="grid__item-door">
                7
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="8" class="grid__item grid__item--8">
            <span class="grid__item-door">
                8
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="9" class="grid__item grid__item--9">
            <span class="grid__item-door">
                9
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="10" class="grid__item grid__item--10">
            <span class="grid__item-door">
                10
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="11" class="grid__item grid__item--sky grid__item--11">
            <span class="grid__item-door">
                11
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="12" class="grid__item grid__item--12">
            <span class="grid__item-door">
                12
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="13" class="grid__item grid__item--moss grid__item--lg grid__item--13">
            <span class="grid__item-door">
                13
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="14" class="grid__item grid__item--14">
            <span class="grid__item-door">
                14
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="15" class="grid__item grid__item--rose grid__item--15">
            <span class="grid__item-door">
                15
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="16" class="grid__item grid__item--16">
            <span class="grid__item-door">
                16
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="17" class="grid__item grid__item--17">
            <span class="grid__item-door">
                17
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="18" class="grid__item grid__item--sky grid__item--18">
            <span class="grid__item-door">
                18
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="19" class="grid__item grid__item--rose grid__item--19">
            <span class="grid__item-door">
                19
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="20" class="grid__item grid__item--20">
            <span class="grid__item-door">
                20
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="21" class="grid__item grid__item--sun grid__item--lg grid__item--21">
            <span class="grid__item-door">
                21
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="22" class="grid__item  grid__item--sun grid__item--22">
            <span class="grid__item-door">
                22
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="23" class="grid__item grid__item--23">
            <span class="grid__item-door">
                23
            </span>
            <span class="grid__item-shadow"></span>
        </button>
        <button data-door-number="24" class="grid__item grid__item--sky grid__item--lg grid__item--24">
            <span class="grid__item-door">
                24
            </span>
            <span class="grid__item-shadow"></span>
        </button>
    </div>    
    <script>
        // Function to handle the door click
        function handleDoorClick(event) {
          // Prevent the default form submission behavior
          event.preventDefault();
      
          // Get the door number from the data attribute of the button
          var doorNumber = event.currentTarget.getAttribute('data-door-number');
      
          // Call the cloud function with the door number
          fetch(`https://advent.jetztundhier.app/.netlify/functions/check-door?door=${doorNumber}`)
            .then(response => {
              if (!response.ok) {
                // If the response is not okay, throw an error to jump to the catch block
                throw new Error('Network response was not ok.');
              }
              return response.json();
            })
            .then(data => {
              if (data.error) {
                // If there is an error message in the data, show it in an alert
                alert(data.error);
              } else {
                // If it's the correct door, redirect to heute.html with the Airtable ID as a parameter
                window.location.href = `heute.html?id=${data.id}`;
              }
            })
            .catch(error => {
              // If there is a fetch error, log it to the console and show a user-friendly message
              console.error('There has been a problem with your fetch operation:', error);
              alert('Es gab ein Problem mit der Anfrage. Bitte versuchen Sie es sp채ter noch einmal.');
            });
        }
      
        // Add click event listener to all door buttons
        document.addEventListener('DOMContentLoaded', function() {
            // Add click event listener to all door buttons
            document.querySelectorAll('.grid__item').forEach(door => {
                door.addEventListener('click', handleDoorClick);
            });
        });
      </script>      
</body>
</html>
